"use strict";(self.webpackChunklearn_data=self.webpackChunklearn_data||[]).push([[3146],{44150:(n,s,e)=>{e.r(s),e.d(s,{default:()=>b});var a=e(64304);const t={href:"https://github.com/n8n-io/n8n",target:"_blank",rel:"noopener noreferrer"},i={href:"https://sspai.com/prime/story/automation-n8n",target:"_blank",rel:"noopener noreferrer"},o={href:"https://reorx.com/blog/sharing-my-footprints-automation/",target:"_blank",rel:"noopener noreferrer"},l=(0,a.uE)('<h2 id="部署-n8n" tabindex="-1"><a class="header-anchor" href="#部署-n8n"><span>部署 n8n</span></a></h2><ol><li>桌面执行 <code>git clone https://github.com/n8n-io/n8n.git</code> 命令下载 n8n 仓库文件，将其复制到 NAS。</li><li>切换路径 <code>cd /volume3/storage/n8n/docker/compose/withPostgres</code>。</li><li>运行 <code>sudo docker-compose up -d</code> 命令进行部署。</li></ol><p>初次部署时，可能会出现 <code>for n8n Container &quot;5a6edd16e779&quot; is unhealthy.</code> 的提示。请忽略该提示，然后再次运行 <code>sudo docker-compose up -d</code> 命令即可解决问题。如果你更新了 git 仓库文件，重新部署时可能会提示无需更新。在这种情况下，你可以首先删除容器，然后重新部署。</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token comment"># https://github.com/n8n-io/n8n/tree/master/docker/compose/withPostgres</span>\n<span class="token comment"># https://docs.n8n.io/hosting/installation/server-setups/docker-compose/#5-create-docker-compose-file</span>\n<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.8&quot;</span>\n\n<span class="token key atrule">services</span><span class="token punctuation">:</span>\n  <span class="token key atrule">n8n-postgres</span><span class="token punctuation">:</span>\n    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres<span class="token punctuation">:</span><span class="token number">11</span>\n    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> n8n<span class="token punctuation">-</span>postgres\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always\n    <span class="token key atrule">environment</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> POSTGRES_USER\n      <span class="token punctuation">-</span> POSTGRES_PASSWORD\n      <span class="token punctuation">-</span> POSTGRES_DB\n      <span class="token punctuation">-</span> POSTGRES_NON_ROOT_USER\n      <span class="token punctuation">-</span> POSTGRES_NON_ROOT_PASSWORD\n    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> /volume1/docker/n8n/db<span class="token punctuation">:</span>/var/lib/postgresql/data\n      <span class="token punctuation">-</span> ./init<span class="token punctuation">-</span>data.sh<span class="token punctuation">:</span>/docker<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>initdb.d/init<span class="token punctuation">-</span>data.sh\n    <span class="token key atrule">healthcheck</span><span class="token punctuation">:</span>\n      <span class="token key atrule">test</span><span class="token punctuation">:</span>\n        <span class="token punctuation">[</span>\n          <span class="token string">&quot;CMD-SHELL&quot;</span><span class="token punctuation">,</span>\n          <span class="token string">&quot;pg_isready -h localhost -U ${POSTGRES_USER} -d ${POSTGRES_DB}&quot;</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span>\n      <span class="token key atrule">interval</span><span class="token punctuation">:</span> 5s\n      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> 5s\n      <span class="token key atrule">retries</span><span class="token punctuation">:</span> <span class="token number">10</span>\n\n  <span class="token key atrule">n8n</span><span class="token punctuation">:</span>\n    <span class="token key atrule">image</span><span class="token punctuation">:</span> docker.n8n.io/n8nio/n8n\n    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> n8n\n    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always\n    <span class="token key atrule">environment</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> N8N_HOST=$<span class="token punctuation">{</span>N8N_HOST<span class="token punctuation">}</span>\n      <span class="token punctuation">-</span> NODE_ENV=production\n      <span class="token punctuation">-</span> N8N_EDITOR_BASE_URL=$<span class="token punctuation">{</span>N8N_EDITOR_BASE_URL<span class="token punctuation">}</span>\n      <span class="token punctuation">-</span> VUE_APP_URL_BASE_API=$<span class="token punctuation">{</span>N8N_EDITOR_BASE_URL<span class="token punctuation">}</span>\n      <span class="token punctuation">-</span> WEBHOOK_URL=$<span class="token punctuation">{</span>N8N_EDITOR_BASE_URL<span class="token punctuation">}</span>\n      <span class="token punctuation">-</span> DB_TYPE=postgresdb\n      <span class="token punctuation">-</span> DB_POSTGRESDB_HOST=n8n<span class="token punctuation">-</span>postgres\n      <span class="token punctuation">-</span> DB_POSTGRESDB_PORT=5432\n      <span class="token punctuation">-</span> DB_POSTGRESDB_DATABASE=$<span class="token punctuation">{</span>POSTGRES_DB<span class="token punctuation">}</span>\n      <span class="token punctuation">-</span> DB_POSTGRESDB_USER=$<span class="token punctuation">{</span>POSTGRES_NON_ROOT_USER<span class="token punctuation">}</span>\n      <span class="token punctuation">-</span> DB_POSTGRESDB_PASSWORD=$<span class="token punctuation">{</span>POSTGRES_NON_ROOT_PASSWORD<span class="token punctuation">}</span>\n      <span class="token punctuation">-</span> TZ=Asia/Shanghai\n    <span class="token key atrule">ports</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> 5720<span class="token punctuation">:</span><span class="token number">5678</span>\n    <span class="token key atrule">links</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> n8n<span class="token punctuation">-</span>postgres\n    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>\n      <span class="token punctuation">-</span> /volume1/docker/n8n/storage<span class="token punctuation">:</span>/home/node/.n8n\n    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>\n      <span class="token key atrule">n8n-postgres</span><span class="token punctuation">:</span>\n        <span class="token key atrule">condition</span><span class="token punctuation">:</span> service_healthy\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上述文件中，我将 <code>/volume1/docker/n8n</code> 指定为 n8n 的设置目录，需要将该路径的读写权限授予 n8n，否则项目启动时可能会报错。</p><h2 id="环境变量" tabindex="-1"><a class="header-anchor" href="#环境变量"><span>环境变量</span></a></h2><p>PostgreSQL 的默认数据库名称、用户和密码可以在当前目录的 <code>.env</code> 文件中更改。</p><div class="language-env line-numbers-mode" data-ext="env" data-title="env"><pre class="language-env"><code>N8N_HOST=localnas.com\nN8N_EDITOR_BASE_URL=http://localnas.com:5720/\n\nPOSTGRES_USER=changeUser\nPOSTGRES_PASSWORD=changePassword\nPOSTGRES_DB=n8n\n\nPOSTGRES_NON_ROOT_USER=changeUser\nPOSTGRES_NON_ROOT_PASSWORD=changePassword\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>N8N_HOST</code> 和 <code>N8N_EDITOR_BASE_URL</code> 用于第三方 API 的回调访问。如果你启用了外网调用 n8n 的访问权限，建议开启 Two-factor authentication (2FA)，以防止 API 信息泄露。不建议将 <code>N8N_HOST</code> 设为内部域名，否则在后续设置中可能会出现 <code>Bad Request: bad webhook: An HTTPS URL must be provided for webhook</code> 错误。</p><h2 id="节点" tabindex="-1"><a class="header-anchor" href="#节点"><span>节点</span></a></h2><h3 id="http-request" tabindex="-1"><a class="header-anchor" href="#http-request"><span>HTTP Request</span></a></h3>',11),p={href:"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/",target:"_blank",rel:"noopener noreferrer"},c=(0,a._)("p",null,"网页端有时可能经常容易连不上，如果你不希望卡住，注意在节点设置的 On Error 选择为 Continue，并在 Options 中添加超时选项 Timeout 10000 ms。",-1),r=(0,a._)("h3",{id:"if",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#if"},[(0,a._)("span",null,"IF")])],-1),u={href:"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.if/",target:"_blank",rel:"noopener noreferrer"},d=(0,a.uE)('<figure><img src="https://img.newzone.top/2023-12-12-22-43-08.png?imageMogr2/format/webp?imageMogr2/format/webp/thumbnail/400x" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="github-trigger" tabindex="-1"><a class="header-anchor" href="#github-trigger"><span>Github Trigger</span></a></h3><p>Github Trigger 通过在 Github 上建立 Webhook 来获取推送。</p><p>有时，节点的设置可能出错，导致以下错误提示：<code>Workflow could not be activated: A webhook with the identical URL probably exists already. Please delete it manually on Github!</code>。这是因为在仓库中存在多个相同的 Webhook 地址所致。请进入 repo 仓库，选择 <code>Settings &gt; Code and automation &gt; Webhooks</code>，手动删除重复的 Webhook 地址，即可使其正常运行。</p><h2 id="使用-tips" tabindex="-1"><a class="header-anchor" href="#使用-tips"><span>使用 Tips</span></a></h2><h3 id="变量路径" tabindex="-1"><a class="header-anchor" href="#变量路径"><span>变量路径</span></a></h3><p>对于一些复杂的输入变量，你可以直接使用 n8n 自带的工具复制路径。在 INPUT 区域选择 JSON，然后点击要选择的参数，接着点击 INPUT 右上角的复制按钮，选择 <code>Copy Parameter Path</code>。</p><figure><img src="https://img.newzone.top/2023-12-14-12-37-36.png?imageMogr2/format/webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="其他操作记录" tabindex="-1"><a class="header-anchor" href="#其他操作记录"><span>其他操作记录</span></a></h2><h3 id="discord-oauth2" tabindex="-1"><a class="header-anchor" href="#discord-oauth2"><span>Discord OAuth2</span></a></h3>',10),k={href:"https://discord.com/developers/applications",target:"_blank",rel:"noopener noreferrer"},m=(0,a._)("p",null,"然后将 CLIENT ID 和 CLIENT SECRET 添加到 n8n 即可。",-1),v={href:"https://support.discord.com/hc/en-us/articles/206346498-Where-can-I-find-my-User-Server-Message-ID-",target:"_blank",rel:"noopener noreferrer"},h={},b=(0,e(86683).Z)(h,[["render",function(n,s){const e=(0,a.up)("ExternalLinkIcon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("p",null,[(0,a._)("a",t,[(0,a.Uk)("n8n"),(0,a.Wm)(e)]),(0,a.Uk)(" 是一款可扩展的工作流程自动化工具。n8n 可用于自行托管，并允许你添加自定义函数、逻辑和应用程序。社区有多种第三方 API 节点，可连接主流海外服务。")]),(0,a._)("p",null,[(0,a.Uk)("对于初学者，建议按照"),(0,a._)("a",i,[(0,a.Uk)("基于 n8n 的开源自动化：以滴答清单同步 Notion 为例"),(0,a.Wm)(e)]),(0,a.Uk)(" 教程进行操作，以熟悉 n8n 的广泛应用。有关使用案例的更多信息，请参阅"),(0,a._)("a",o,[(0,a.Uk)("使用自动化工作流聚合信息摄入和输出"),(0,a.Wm)(e)]),(0,a.Uk)("。")]),l,(0,a._)("p",null,[(0,a._)("a",p,[(0,a.Uk)("HTTP Request"),(0,a.Wm)(e)]),(0,a.Uk)(" 是使用 REST API 发出 HTTP 请求以查询来自任何应用程序或服务的数据。")]),c,r,(0,a._)("p",null,[(0,a._)("a",u,[(0,a.Uk)("IF"),(0,a.Wm)(e)]),(0,a.Uk)(" 是根据比较操作有条件地分割工作流。请注意，Boolean 判断的 true、false 需要使用双重花括号框中。")]),d,(0,a._)("p",null,[(0,a.Uk)("在 "),(0,a._)("a",k,[(0,a.Uk)("Discord Applications"),(0,a.Wm)(e)]),(0,a.Uk)(" 新建任意名称的应用，然后在 OAuth2>General > Redirects 中添加回调地址。")]),m,(0,a._)("ul",null,[(0,a._)("li",null,[(0,a._)("a",v,[(0,a.Uk)("Where can I find my User/Server/Message ID?"),(0,a.Wm)(e)])])])])}]])},86683:(n,s)=>{s.Z=(n,s)=>{const e=n.__vccOpts||n;for(const[n,a]of s)e[n]=a;return e}},62359:(n,s,e)=>{e.r(s),e.d(s,{data:()=>a});const a=JSON.parse('{"key":"v-1f9c1940","path":"/services/dockers-on-nas/n8n.html","title":"n8n：工作流自动化","lang":"zh-CN","frontmatter":{"article":false,"title":"n8n：工作流自动化","order":81,"description":"n8n 是一款可扩展的工作流程自动化工具。n8n 可用于自行托管，并允许你添加自定义函数、逻辑和应用程序。社区有多种第三方 API 节点，可连接主流海外服务。 对于初学者，建议按照基于 n8n 的开源自动化：以滴答清单同步 Notion 为例 教程进行操作，以熟悉 n8n 的广泛应用。有关使用案例的更多信息，请参阅使用自动化工作流聚合信息摄入和输出。","head":[["meta",{"property":"og:url","content":"https://newzone.top/services/dockers-on-nas/n8n.html"}],["meta",{"property":"og:site_name","content":"LearnData-开源笔记"}],["meta",{"property":"og:title","content":"n8n：工作流自动化"}],["meta",{"property":"og:description","content":"n8n 是一款可扩展的工作流程自动化工具。n8n 可用于自行托管，并允许你添加自定义函数、逻辑和应用程序。社区有多种第三方 API 节点，可连接主流海外服务。 对于初学者，建议按照基于 n8n 的开源自动化：以滴答清单同步 Notion 为例 教程进行操作，以熟悉 n8n 的广泛应用。有关使用案例的更多信息，请参阅使用自动化工作流聚合信息摄入和输出。"}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-23T10:09:14.000Z"}],["meta",{"property":"article:author","content":"清顺"}],["meta",{"property":"article:modified_time","content":"2024-01-23T10:09:14.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"WebPage\\",\\"name\\":\\"n8n：工作流自动化\\",\\"description\\":\\"n8n 是一款可扩展的工作流程自动化工具。n8n 可用于自行托管，并允许你添加自定义函数、逻辑和应用程序。社区有多种第三方 API 节点，可连接主流海外服务。 对于初学者，建议按照基于 n8n 的开源自动化：以滴答清单同步 Notion 为例 教程进行操作，以熟悉 n8n 的广泛应用。有关使用案例的更多信息，请参阅使用自动化工作流聚合信息摄入和输出。\\"}"]]},"headers":[{"level":2,"title":"部署 n8n","slug":"部署-n8n","link":"#部署-n8n","children":[]},{"level":2,"title":"环境变量","slug":"环境变量","link":"#环境变量","children":[]},{"level":2,"title":"节点","slug":"节点","link":"#节点","children":[{"level":3,"title":"HTTP Request","slug":"http-request","link":"#http-request","children":[]},{"level":3,"title":"IF","slug":"if","link":"#if","children":[]},{"level":3,"title":"Github Trigger","slug":"github-trigger","link":"#github-trigger","children":[]}]},{"level":2,"title":"使用 Tips","slug":"使用-tips","link":"#使用-tips","children":[{"level":3,"title":"变量路径","slug":"变量路径","link":"#变量路径","children":[]}]},{"level":2,"title":"其他操作记录","slug":"其他操作记录","link":"#其他操作记录","children":[{"level":3,"title":"Discord OAuth2","slug":"discord-oauth2","link":"#discord-oauth2","children":[]}]}],"git":{"createdTime":1701852517000,"updatedTime":1706004554000,"contributors":[{"name":"rockbenben","email":"qingwhat@gmail.com","commits":5}]},"readingTime":{"minutes":3.24,"words":972},"filePathRelative":"services/dockers-on-nas/n8n.md","localizedDate":"2023年12月6日","excerpt":"<p><a href=\\"https://github.com/n8n-io/n8n\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">n8n</a> 是一款可扩展的工作流程自动化工具。n8n 可用于自行托管，并允许你添加自定义函数、逻辑和应用程序。社区有多种第三方 API 节点，可连接主流海外服务。</p>\\n<p>对于初学者，建议按照<a href=\\"https://sspai.com/prime/story/automation-n8n\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">基于 n8n 的开源自动化：以滴答清单同步 Notion 为例</a> 教程进行操作，以熟悉 n8n 的广泛应用。有关使用案例的更多信息，请参阅<a href=\\"https://reorx.com/blog/sharing-my-footprints-automation/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">使用自动化工作流聚合信息摄入和输出</a>。</p>","autoDesc":true}')}}]);